# PRD: User Engagement Tab

## Overview
## MVP Scope
This PRD applies to the **Analytics → User Engagement** tab (MVP).

## Overview
The User Engagement tab provides detailed insights into user activity patterns, engagement metrics, and participation trends. This tab focuses on understanding how users interact with the program and benefit offerings.

## Objectives
- Track active user metrics (DAU, WAU, MAU)
- Understand engagement funnel and conversion rates
- Analyze user segmentation and behavior patterns
- Monitor entitlement utilization by benefit type

## Key Performance Indicators (KPIs)

### Engagement Metrics KPI Cards
1. **MAU (Monthly Active Users)**
   - Definition: Unique users who engaged with the program in the past 30 days
   - Display: Formatted number with trend indicator
   - Trend: Percentage change from previous period

2. **DAU (Daily Active Users)**
   - Definition: Unique users who engaged with the program in the past 24 hours
   - Display: Formatted number with trend indicator
   - Trend: Percentage change from previous period

3. **MAC (Monthly Active with Orders)**
   - Definition: Users who completed at least one order in the past 30 days
   - Display: Formatted number with trend indicator
   - Trend: Percentage change from previous period

4. **Total Requests**
   - Definition: Count of all assisted user requests in the selected time period. A request includes informational requests (recommendations, Q&A, trip planning) and order-related requests.
   - Display: Formatted number with trend indicator
   - Trend: Percentage change from previous period

5. **Request Rate**
   - Definition: Percentage of total users that made at least one request. Calculated as (Users with Requests / Total Users) × 100%.
   - Display: Percentage with trend indicator
   - Trend: Percentage change from previous period

6. **Repeat Users**
   - Definition: Users with multiple orders
   - Display: Formatted number with trend indicator
   - Trend: Percentage change from previous period

7. **Entitlement Utilization**
   - Definition: Percentage of allocated benefits used by users
   - Display: Percentage with trend indicator
   - Note: Uses selected time period filter

## Charts and Visualizations

### User Engagement Funnel
- **Type**: Funnel Visualization
- **Purpose**: Shows conversion from eligible to repeat users
- **Stages**:
  1. Eligible Users (100% baseline)
  2. Users with Requests (percentage of eligible)
  3. Users with Orders (percentage of eligible)
  4. Users with Repeat Orders (percentage of eligible)
- **Display**:
  - Each stage shows count and percentage
  - Visual bar width represents percentage of eligible
  - Color-coded bars with gradient
  - Hover effects for interactivity

### Daily Active Trends
- **Type**: Multi-line Chart
- **Data**: Daily active user trends over time
- **Time Range**: Last 30 days (fixed view regardless of filter)
- **Series**:
  - DAU (Daily Active Users) - red line
  - WAU (Weekly Active Users) - purple line
  - MAU (Monthly Active Users) - navy line
- **X-Axis**: Dates (last 30 days)
- **Y-Axis**: User count

### Entitlement Utilization by Benefit Type
- **Type**: Horizontal Bar Chart
- **Data**: Utilization percentage by benefit category
- **Display**: 
  - Benefit types on Y-axis
  - Utilization percentage on X-axis (0-100%)
  - Color-coded bars
- **Purpose**: Identify which benefits are most/least utilized

## Tables

### User Segmentation
- **Purpose**: Breakdown of users by engagement segment
- **Columns**:
  1. **Segment** - User category (New, Active, Repeat)
  2. **Users** - Count of users in segment
  3. **Avg. Orders** - Average number of orders per user
  4. **Value** - Total value generated by segment
  5. **Trend** - Percentage change in segment size

### Table Features
- Data formatted for readability
- Currency values properly formatted
- Trend indicators with directional arrows
- Responsive design

## Data Filtering

### Time Period Filter
- All metrics respect the global time period filter
- DAU/WAU/MAU metrics calculate based on selected period
- Daily Active Trends chart shows last 30 days regardless of filter (fixed view)
- Entitlement Utilization respects the selected time period
- Funnel data uses current period for calculations

## Metric Definitions

### Tooltips Available
- **MAU**: Monthly Active Users - Unique users who engaged with the program in the past 30 days
- **DAU**: Daily Active Users - Unique users who engaged with the program in the past 24 hours
- **MAC**: Monthly Active with Orders - Users who completed at least one order in the past 30 days
- **Total Requests**: Count of all assisted user requests in the selected time period. A request includes informational requests (recommendations, Q&A, trip planning) and order-related requests.
- **Request Rate**: Percentage of total users that made at least one request. Calculated as (Users with Requests / Total Users) × 100%.
- **Repeat Users**: Users with multiple orders
- **Entitlement Utilization**: Percentage of allocated benefits used by users within the selected time period
- **WAU**: Weekly Active Users - Unique users who engaged with the program in the past 7 days

## Engagement Funnel Logic

### Calculation
1. **Eligible Users**: Total eligible (baseline = 100%)
2. **Users with Requests**: Users with requests / Eligible × 100%
3. **Users with Orders**: Users with orders / Eligible × 100%
4. **Users with Repeat Orders**: Users with repeat orders / Eligible × 100%

### Visual Representation
- Each stage displayed as horizontal bar
- Bar width proportional to percentage of eligible
- Count and percentage displayed on each bar
- Progressive narrowing indicates conversion funnel

## Loading and Error States

### Loading State
- Display loading indicator while fetching data
- Show "Loading engagement metrics..." message
- Maintain layout structure during load

### Error State
- Display error message if data fails to load
- Allow retry without page refresh
- Show "Error loading data. Please try again." message

## Data Structure

| Data Field | Definition | Calculation | Data Source |
|------------|------------|-------------|-------------|
| mau | Monthly Active Users - Unique users who engaged with the program in the past 30 days | Count of unique users with at least one engagement event in the past 30 days | |
| mauTrend | Percentage change in MAU compared to previous period | ((Current Period - Previous Period) / Previous Period) × 100% | |
| dau | Daily Active Users - Unique users who engaged with the program in the past 24 hours | Count of unique users with at least one engagement event in the past 24 hours | |
| dauTrend | Percentage change in DAU compared to previous period | ((Current Period - Previous Period) / Previous Period) × 100% | |
| mac | Monthly Active with Orders - Users who completed at least one order in the past 30 days | Count of unique users with at least one completed order in the past 30 days | |
| macTrend | Percentage change in MAC compared to previous period | ((Current Period - Previous Period) / Previous Period) × 100% | |
| totalRequests | Total assisted user requests in the selected time period | Count of all assisted user requests | |
| usersWithRequests | Users who made at least one request in the selected time period | Count of unique users with ≥1 request | |
| requestRate | Percentage of total users that made at least one request | (Users with Requests / Total Users) × 100% | |
| repeatUsers | Users who have completed multiple transactions or bookings | Count of unique users with 2 or more completed orders | |
| repeatUsersTrend | Percentage change in repeat users compared to previous period | ((Current Period - Previous Period) / Previous Period) × 100% | |
| funnel | Engagement funnel object containing counts for each stage | Object with eligible, active, withOrders, and repeat counts | |
| funnel.eligible | Total number of eligible users | Count of all users eligible to participate in the program | |
| funnel.withOrders | Count of users who have placed at least one order | Count of unique users with at least one completed order | |
| funnel.repeat | Count of users with repeat orders | Count of unique users with 2 or more completed orders | |
| dailyActiveTrend | Array of daily active user trend data objects | Collection of daily counts for DAU, WAU, MAU over 30 days | |
| dailyActiveTrend[].date | Date identifier in YYYY-MM-DD format | Date extraction from engagement event timestamps | |
| dailyActiveTrend[].dau | Daily Active Users count for the date | Count of unique users with engagement on the specific date | |
| dailyActiveTrend[].wau | Weekly Active Users count for the date | Count of unique users with engagement in the 7 days ending on the date | |
| dailyActiveTrend[].mau | Monthly Active Users count for the date | Count of unique users with engagement in the 30 days ending on the date | |
| memberSegments | Array of user segmentation data objects | Collection of user segments with metrics | |
| memberSegments[].segment | Segment name (New, Active, Repeat) | Classification based on user engagement behavior | |
| memberSegments[].members | Count of users in the segment | Count of unique users classified in this segment | |
| memberSegments[].avgOrders | Average number of orders per user in segment | Total Orders in Segment / Users in Segment | |
| memberSegments[].value | Total value generated by segment | Sum of all transaction values for users in this segment | |
| memberSegments[].trend | Percentage change in segment size | ((Current Period - Previous Period) / Previous Period) × 100% | |
| entitlementUtilization | Array of entitlement utilization data by benefit type | Collection of utilization metrics for each benefit type | |
| entitlementUtilization[].type | Benefit type name (e.g., Lounge Access, Airport Transfers) | Benefit category classification | |
| entitlementUtilization[].used | Count of benefits used | Count of benefit redemptions for this type | |
| entitlementUtilization[].allocated | Count of benefits allocated | Total benefits allocated to members for this type | |
| entitlementUtilization[].utilization | Utilization percentage for this benefit type | (Used / Allocated) × 100% | |
| engagementDepth | Average number of interactions per active user within the selected period | Total Interactions / Active Users | |
| engagementDepthTrend | Change in engagement depth compared to previous period | Current Period Depth - Previous Period Depth | |
| retentionCohorts | Array of retention cohort data objects | Collection of retention rates by time period | |
| retentionCohorts[].period | Time period identifier (e.g., '1 day', '7 days', '30 days') | Period classification for retention measurement | |
| retentionCohorts[].rate | Retention rate percentage for the period | Percentage of members who remain active over the specified period | |
| benefitUsage | Array of benefit usage pattern data objects | Collection of usage patterns by benefit category | |
| benefitUsage[].category | Benefit category name | Benefit classification | |
| benefitUsage[].new | Count of members who are new users of this benefit | Count of members using this benefit for the first time | |
| benefitUsage[].occasional | Count of members who occasionally use this benefit | Count of members with 2-5 uses of this benefit | |
| benefitUsage[].regular | Count of members who regularly use this benefit | Count of members with 6+ uses of this benefit | |

